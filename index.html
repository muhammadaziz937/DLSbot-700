<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DLS bot 700</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <div class="chat-container">
    <div class="messages" id="messages"></div>
    <div class="composer">
      <input type="text" id="input" placeholder="Savolingizni yozing...">
      <button onclick="sendMessage()">Yubor</button>
    </div>
  </div>
  <div class="history">
    <h3>📂 Suhbatlar</h3>
    <div class="history-list" id="historyList"></div>
    <button class="add-btn" onclick="newChat()">➕ Yangi suhbat</button>
  </div>

  <script>
    const input = document.getElementById("input");
    const messagesDiv = document.getElementById("messages");
    const historyList = document.getElementById("historyList");

    let chats = JSON.parse(localStorage.getItem("chats")) || [];
    let currentChatId = null;

    window.onload = () => {
      input.focus();
      if (!chats.length) newChat(); 
      else {
        currentChatId = chats[chats.length - 1].id;
        renderHistory();
        loadChat(currentChatId);
      }
    };

    input.addEventListener("keydown", e => {
      if (e.key === "Enter" && !/Mobi|Android/i.test(navigator.userAgent)) {
        sendMessage();
      }
    });

    function newChat() {
      const id = Date.now();
      chats.push({ id, title: "Chat " + chats.length, messages: [] });
      currentChatId = id;
      saveChats();
      renderHistory();
      loadChat(id);
    }

    function sendMessage() {
      let text = input.value.trim().toLowerCase();
      if (!text) return;
      addMessage(text, "user");
      input.value = ""; input.focus();

      let reply = "Bu savol DLS 25 ga oid emas.";
      if (text.includes("salom")) reply = "Salom! DLS 25 bo‘yicha qanday yordam kerak?";
      else if (text.includes("isming")) reply = "Mening ismim DLS Bot 700.";
      else if (text.includes("eng yaxshi")) reply = "DLS 25 da eng yaxshi futbolchilar: Mbappé, Haaland, Messi.";
      else if (text.includes("transfer")) reply = "Transfer qilish uchun coins kerak bo‘ladi.";
      else if (text.includes("stadion")) reply = "Stadionni yangilash jamoa darajasini oshiradi.";
      else if (text.includes("taktika")) reply = "Eng mashhur taktika 4-3-3 va 4-2-3-1.";
      else if (text.includes("coins")) reply = "Coinslarni yutib olish yoki sotib olish mumkin.";
      else if (text.includes("multiplayer")) reply = "Multiplayerda do‘stlaring bilan o‘ynash mumkin.";
      else if (text.includes("forma")) reply = "Formani sozlash uchun “Edit Kit” bo‘limiga kirasiz.";
      else if (text.includes("murabbiy")) reply = "Murabbiy jamoa kuchini oshiradi.";
      else if (text.includes("update")) reply = "So‘nggi yangilanishda grafika va transfer tizimi yaxshilandi.";
      else if (text.includes("dls 25")) reply = "DLS 25 — Dream League Soccer’ning eng so‘nggi versiyasi.";

      setTimeout(() => addMessage(reply, "bot"), 700);
    }

    function addMessage(text, sender) {
      const wrapper = document.createElement("div");
      wrapper.className = "msg-box " + sender;

      const avatar = document.createElement("div");
      avatar.className = "avatar " + sender;

      const msg = document.createElement("div");
      msg.className = "msg";
      msg.textContent = text;

      wrapper.appendChild(avatar);
      wrapper.appendChild(msg);
      messagesDiv.appendChild(wrapper);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;

      let chat = chats.find(c => c.id === currentChatId);
      chat.messages.push({ sender, text });
      saveChats();
    }

    function loadChat(id) {
      messagesDiv.innerHTML = "";
      let chat = chats.find(c => c.id === id);
      if (chat) {
        chat.messages.forEach(m => addMessage(m.text, m.sender));
      }
    }

    function renderHistory() {
      historyList.innerHTML = "";
      chats.forEach(chat => {
        const item = document.createElement("div");
        item.className = "chat-item";

        const title = document.createElement("span");
        title.textContent = chat.title;
        title.onclick = () => { currentChatId = chat.id; loadChat(chat.id); };

        const delBtn = document.createElement("button");
        delBtn.textContent = "❌";
        delBtn.onclick = e => { e.stopPropagation(); deleteChat(chat.id); };

        item.appendChild(title);
        item.appendChild(delBtn);
        historyList.appendChild(item);
      });
    }

    function deleteChat(id) {
      chats = chats.filter(c => c.id !== id);
      saveChats();
      renderHistory();
      if (chats.length) {
        currentChatId = chats[chats.length - 1].id;
        loadChat(currentChatId);
      } else {
        newChat();
      }
    }

    function saveChats() {
      localStorage.setItem("chats", JSON.stringify(chats));
    }
  </script>
</body>
</html>
